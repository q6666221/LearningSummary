## 模板

### 概述

* Web 模板就是一些预先设计好的 HTML 页面，名为模板引擎的软件程序会通过重复使用这些页面来创建一个或者多个 HTML 页面

## 介绍

* `html/template`包实现了数据驱动的模板，用于生成可防止代码注入的安全的HTML内容
  * Go语言中输出HTML的场景都应使用
* 它提供了和`text/template`包相同的接口
* 模板
  * 可以理解为事先定义好的HTML文档文件
* 模板渲染
  * 作用机制可以简单理解为文本替换操作–使用相应的数据去替换HTML文档中事先准备好的标记。

## 作用机制

* 模板文件通常定义为`.tmpl`和`.tpl`为后缀（也可以使用其他的后缀），必须使用`UTF8`编码。
* 模板文件中使用`{{`和`}}`包裹和标识需要传入的数据。
* 传给模板这样的数据就可以通过点号（`.`）来访问，如果数据是复杂类型的数据，可以通过{ { .FieldName }}来访问它的字段。
* 除`{{`和`}}`包裹的内容外，其他内容均不做修改原样输

### 模板引擎

* 作用
  
  * 模引擎将数据和模板组合在一起，一起生成最终的 HTML 页面，处理器负责调用模板引擎将引擎生成的 HTML 返回给客户端

* 分类
  
  * web 引擎没有对应标准，因为不同原因创造出出来的模板，有不同的特点
  
  * 划分为理想( 极端 )的两类
    
    * 无逻辑模板引擎 （logic-less template engine）
      
      ```go
      模板中占位符替换成相对应的动态数据
      此模板只进行字符串替换，不执行任何逻辑
      目的是 ： 
          完全分离程序的表现和逻辑，并将所有计算方面的工作都交给处理器处理
      优点
          不需要进行逻辑处理，渲染速度更快
      ```
    
    * 嵌入逻辑的模板引擎（embedded logic template engine）
      
      ```go
      将编程语言嵌入到模板当中，并在模板引擎渲染模板的时候，由模板引擎执行这些代码，并进行显影字符串替换工作
      拥有在模板中嵌入逻辑的能力，此类模板功能强大
      缺点：
          导致逻辑分散遍布在不同的处理器中，使代码难以维护
      ```

* go 中的引擎
  
  ```go
  text/template    大部分模板引擎功能。可以处理任意格式的文本
  html/template     小部分与 HTML 相关的功能，专门为 html 设计的
  使用步骤
      1. 对文本格式的模板源进行语法分析，创建一个经过语法分析的模板结构，
          模板源 ：可以是字符串，也可以是模板文件中包含的内容
      2. 经过语法分析的模板，将 ResoibseWriter 和模板需要的动态数据传给模板引擎，被调用的引擎会把经过语法分析模板和传入的数据结合起来，生成最终的 HTML ，并将这 HTML 传递给 ResponseWriter
  ```
  
  * 流程
    
    ![image-20201111145623369](../../../../../../%2525E7%25259F%2525A5%2525E8%2525AF%252586%2525E5%2525BA%252593/%2525E4%2525B8%25258A%2525E5%2525BA%252593/web/goweb/%2525E6%2525A0%252587%2525E5%252587%252586%2525E5%2525BA%252593/template/image-20201111145623369.png)
  
  ```go
  处理器触发模板引擎  
      ---模板文件列表-方式-->  传入模板  ------> 传入动态数据  ------>  引擎生成相应的 HTML ------> 文件写入 ResponseWriter ------> Http 响应  ------> 返回客户端
  ```

## text_template

[text_template](D:\desk\知识库\上库\web\goweb\标准库\template)

* 动作

## html_template

* 模板渲染